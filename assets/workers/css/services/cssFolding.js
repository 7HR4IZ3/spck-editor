!function(e){if("object"==typeof module&&"object"==typeof module.exports){var n=e(require,exports);void 0!==n&&(module.exports=n)}else"function"==typeof define&&define.amd&&define(["require","exports","../parser/cssScanner","../parser/scssScanner","../parser/lessScanner"],e)}((function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("../parser/cssScanner"),t=e("../parser/scssScanner"),i=e("../parser/lessScanner");function s(e,n){if(0===e.length)return null;for(var r=e.length-1;r>=0;r--)if(e[r].type===n&&e[r].isStart)return e.splice(r,1)[0];return null}n.getFoldingRanges=function(e,n){var a=function(e){function n(n){return e.positionAt(n.offset).line}function a(n){return e.positionAt(n.offset+n.len).line}function o(){switch(e.languageId){case"scss":return new t.SCSSScanner;case"less":return new i.LESSScanner;default:return new r.Scanner}}function c(e,r){var t=n(e),i=a(e);return t!==i?{startLine:t,endLine:i,kind:r}:null}var u=[],l=[],f=o();f.ignoreComment=!1,f.setSource(e.getText());var p,d=f.scan(),g=function(){switch(d.type){case r.TokenType.CurlyL:case t.InterpolationFunction:l.push({line:n(d),type:"brace",isStart:!0});break;case r.TokenType.CurlyR:if(0!==l.length){if(!(S=s(l,"brace")))break;var i=a(d);"brace"===S.type&&(a(p)!==i&&i--,S.line!==i&&u.push({startLine:S.line,endLine:i,kind:void 0}))}break;case r.TokenType.Comment:var o=function(e){return"#region"===e?{line:n(d),type:"comment",isStart:!0}:{line:a(d),type:"comment",isStart:!1}},g=function(n){var r=n.text.match(/^\s*\/\*\s*(#region|#endregion)\b\s*(.*?)\s*\*\//);if(r)return o(r[1]);if("scss"===e.languageId||"less"===e.languageId){var t=n.text.match(/^\s*\/\/\s*(#region|#endregion)\b\s*(.*?)\s*/);if(t)return o(t[1])}return null},m=g(d);if(m)if(m.isStart)l.push(m);else{var S;if(!(S=s(l,"comment")))break;"comment"===S.type&&S.line!==m.line&&u.push({startLine:S.line,endLine:m.line,kind:"region"})}else{var v=c(d,"comment");v&&u.push(v)}}p=d,d=f.scan()};for(;d.type!==r.TokenType.EOF;)g();return u}(e);return function(e,n){var r=n&&n.rangeLimit||Number.MAX_VALUE,t=e.sort((function(e,n){var r=e.startLine-n.startLine;return 0===r&&(r=e.endLine-n.endLine),r})),i=[],s=-1;return t.forEach((function(e){e.startLine<s&&s<e.endLine||(i.push(e),s=e.endLine)})),i.length<r?i:i.slice(0,r)}(a,n)}}));