!function(){importScripts("idb-keyval.js"),importScripts("bot.js");var e=[];function t(e){return new Promise((function(t,n){var a=new XMLHttpRequest;a.open("GET",e,!0),a.onreadystatechange=function(){4===a.readyState&&(200===a.status?t(a.responseText):n({status:a.status}))},a.send()}))}function n(t){return e.filter((function(e){return e.name===t}))[0]}function a(t){var a=t.currentLanguage;switch(t.action){case"install":if(-1===e.map((function(e){e.name})).indexOf(t.name)){var s=new Bot(t.name);!function(e,t){try{self.Function('"use strict";return (function(bot,'+r+"){"+t+"})")()(e)}catch(e){return console.error(e),!1}}(s,t.script),function(t){e.push(t),postMessage({scope:"bot",action:"addCommands",commands:t.commands,name:t.name})}(s)}else postMessage({scope:"bot",action:"warn",message:'Bot install failed because the name "'+t.name+'" conflicts with another Bot.'});break;case"put":var o=t.message,c=e.reduce((function(e,t){try{t.take&&t.take(o,a)&&e.push(t.name)}catch(e){}return e}),[]);if(0===c.length)postMessage({scope:"bot",action:"reply",message:'Command "'+o+'" not recognized.'});else if(1===c.length){var i=n(c[0]);"function"==typeof i.onmessage&&i.onmessage(o,new App({name:i.name,currentFile:t.currentFile,currentProject:t.currentProject,currentLanguage:a}))}else postMessage({scope:"bot",action:"specify",names:c,message:o,currentFile:t.currentFile,currentProject:t.currentProject,currentLanguage:a});break;case"specify":var u=n(t.name);if(u&&"function"==typeof u.onmessage)try{u.onmessage(t.message,new App({name:t.name,currentFile:t.currentFile,currentProject:t.currentProject,currentLanguage:a}))}catch(e){}break;case"complete":var l=t.completionId;e.forEach((function(e){if("function"==typeof e.oncomplete){var n=new ReadOnlyApp({name:e.name,currentFile:t.currentFile,currentProject:t.currentProject,currentLanguage:a});try{var r=e.oncomplete(t.prefix,n);Promise.resolve(r).then((function(e){Array.isArray(e)&&e.length&&postMessage({scope:"bot",action:"complete",prefix:t.prefix,completions:e,completionId:l,contextAwareLevel:n.editor.contextAwareLevel})}))}catch(e){}}}))}}self.addEventListener("message",(function(e){var t=e.data;t&&a(t)})),Promise.all([t("scripts/help.js").then((function(e){a({action:"install",name:"help",script:e})})),t("scripts/navigate.js").then((function(e){a({action:"install",name:"navigate",script:e})})),t("scripts/bookmark.js").then((function(e){a({action:"install",name:"bookmark",script:e})})),t("scripts/string.js").then((function(e){a({action:"install",name:"string",script:e})})),t("scripts/editor.js").then((function(e){a({action:"install",name:"editor",script:e})})),t("scripts/javascript.js").then((function(e){a({action:"install",name:"javascript",script:e})})),t("scripts/clipboard.js").then((function(e){a({action:"install",name:"clipboard",script:e})}))]).then((function(){postMessage({action:"initialized"})}));var r=["self","globalThis","Function","addEventListener","removeEventListener","fetch","XMLHttpRequest","WebSocket","MessageChannel","postMessage","requestAnimationFrame","cancelAnimationFrame","queueMicrotask","setInterval","setTimeout","clearInterval","clearTimeout","navigator","performance","crypto","location","indexedDB","idbKeyval","caches","importScripts","trustedTypes","webkitRequestFileSystem","webkitRequestFileSystemSync","webkitResolveLocalFileSystemSyncURL","webkitResolveLocalFileSystemURL","Worker","onmessage","onerror","onmessageerror","onrejectionhandled","onunhandledrejection","onlanguagechange","origin"].join(",")}();