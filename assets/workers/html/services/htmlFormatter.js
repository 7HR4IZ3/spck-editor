!function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports);void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define(["require","exports","vscode-languageserver-types","../beautify/beautify-html","../utils/strings"],e)}((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=e("vscode-languageserver-types"),r=e("../beautify/beautify-html"),i=e("../utils/strings");function a(e,t,n){if(e&&e.hasOwnProperty(t)){var r=e[t];if(null!==r)return r}return n}function s(e,t,n){var r=a(e,t,null);return"string"==typeof r?r.length>0?r.split(",").map((function(e){return e.trim().toLowerCase()})):[]:n}function o(e,t){return-1!=="\r\n".indexOf(e.charAt(t))}function f(e,t){return-1!==" \t".indexOf(e.charAt(t))}t.format=function(e,t,u){var l=e.getText(),d=!0,p=0,c=u.tabSize||4;if(t){for(var v=e.offsetAt(t.start),g=v;g>0&&f(l,g-1);)g--;0===g||o(l,g-1)?v=g:g<v&&(v=g+1);for(var _=e.offsetAt(t.end),h=_;h<l.length&&f(l,h);)h++;(h===l.length||o(l,h))&&(_=h),t=n.Range.create(e.positionAt(v),e.positionAt(_));var b=l.substring(0,v);if(new RegExp(/.*[<][^>]*$/).test(b))return[{range:t,newText:l=l.substring(v,_)}];if(d=_===l.length,l=l.substring(v,_),0!==v){var m=e.offsetAt(n.Position.create(t.start.line,0));p=function(e,t,n){var r=t,i=0,a=n.tabSize||4;for(;r<e.length;){var s=e.charAt(r);if(" "===s)i++;else{if("\t"!==s)break;i+=a}r++}return Math.floor(i/a)}(e.getText(),m,u)}}else t=n.Range.create(n.Position.create(0,0),e.positionAt(l.length));var w={indent_size:c,indent_char:u.insertSpaces?" ":"\t",indent_empty_lines:a(u,"indentEmptyLines",!1),wrap_line_length:a(u,"wrapLineLength",120),unformatted:s(u,"unformatted",void 0),content_unformatted:s(u,"contentUnformatted",void 0),indent_inner_html:a(u,"indentInnerHtml",!1),preserve_newlines:a(u,"preserveNewLines",!0),max_preserve_newlines:a(u,"maxPreserveNewLines",32786),indent_handlebars:a(u,"indentHandlebars",!1),end_with_newline:d&&a(u,"endWithNewline",!1),extra_liners:s(u,"extraLiners",void 0),wrap_attributes:a(u,"wrapAttributes","auto"),wrap_attributes_indent_size:a(u,"wrapAttributesIndentSize",void 0),eol:"\n"},x=r.html_beautify(l.replace(/^\s+/,""),w);if(p>0){var y=u.insertSpaces?i.repeat(" ",c*p):i.repeat("\t",p);x=x.split("\n").join("\n"+y),0===t.start.character&&(x=y+x)}return[{range:t,newText:x}]}}));