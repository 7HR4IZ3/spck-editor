!function(t){if("object"==typeof module&&"object"==typeof module.exports){var e=t(require,exports);void 0!==e&&(module.exports=e)}else"function"==typeof define&&define.amd&&define(["require","exports","vscode-languageserver-types","../parser/htmlScanner","../parser/htmlParser","../htmlLanguageTypes"],t)}((function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=t("vscode-languageserver-types"),a=t("../parser/htmlScanner"),r=t("../parser/htmlParser"),s=t("../htmlLanguageTypes");function o(t,e,r){for(var o=n.Range.create(t.positionAt(e.start),t.positionAt(e.end)),g=t.getText(o),f=r-e.start,i=a.createScanner(g),d=i.scan(),T=e.start,u=[],c=!1,p=-1;d!==s.TokenType.EOS;){switch(d){case s.TokenType.AttributeName:if(f<i.getTokenOffset()){c=!1;break}f<=i.getTokenEnd()&&u.unshift([i.getTokenOffset(),i.getTokenEnd()]),c=!0,p=i.getTokenOffset();break;case s.TokenType.AttributeValue:if(!c)break;var k=i.getTokenText();if(f<i.getTokenOffset()){u.push([p,i.getTokenEnd()]);break}f>=i.getTokenOffset()&&f<=i.getTokenEnd()&&(u.unshift([i.getTokenOffset(),i.getTokenEnd()]),('"'===k[0]&&'"'===k[k.length-1]||"'"===k[0]&&"'"===k[k.length-1])&&f>=i.getTokenOffset()+1&&f<=i.getTokenEnd()-1&&u.unshift([i.getTokenOffset()+1,i.getTokenEnd()-1]),u.push([p,i.getTokenEnd()]))}d=i.scan()}return u.map((function(t){return[t[0]+T,t[1]+T]}))}e.getSelectionRanges=function(t,e){return e.map((function(e){for(var a=function(t,e){var a=r.parse(t.getText()),s=t.offsetAt(e),g=a.findNodeAt(s),f=function(t){var e=t,n=function(t){return t.startTagEnd&&t.endTagStart&&t.startTagEnd<t.endTagStart?[[t.startTagEnd,t.endTagStart],[t.start,t.end]]:[[t.start,t.end]]},a=[];for(;e.parent;)n(e=e.parent).forEach((function(t){return a.push(t)}));return a}(g);if(g.startTagEnd&&!g.endTagStart){if(g.startTagEnd!==g.end)return[[g.start,g.end]];var i=n.Range.create(t.positionAt(g.startTagEnd-2),t.positionAt(g.startTagEnd));return"/>"===t.getText(i)?f.unshift([g.start+1,g.startTagEnd-2]):f.unshift([g.start+1,g.startTagEnd-1]),f=o(t,g,s).concat(f)}if(!g.startTagEnd||!g.endTagStart)return f;return f.unshift([g.start,g.end]),g.start<s&&s<g.startTagEnd?(f.unshift([g.start+1,g.startTagEnd-1]),f=o(t,g,s).concat(f)):g.startTagEnd<=s&&s<=g.endTagStart?(f.unshift([g.startTagEnd,g.endTagStart]),f):(s>=g.endTagStart+2&&f.unshift([g.endTagStart+2,g.end-1]),f)}(t,e),s=void 0,g=void 0,f=a.length-1;f>=0;f--){var i=a[f];s&&i[0]===s[0]&&i[1]===s[1]||(g=n.SelectionRange.create(n.Range.create(t.positionAt(a[f][0]),t.positionAt(a[f][1])),g)),s=i}return g||(g=n.SelectionRange.create(n.Range.create(e,e))),g}))}}));