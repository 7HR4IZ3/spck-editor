!function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports);void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define(["require","exports","vscode-nls","../htmlLanguageTypes"],e)}((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=e("vscode-nls"),a=e("../htmlLanguageTypes"),r=n.loadMessageBundle(),o=function(){function e(e,t){this.source=e,this.len=e.length,this.position=t}return e.prototype.eos=function(){return this.len<=this.position},e.prototype.getSource=function(){return this.source},e.prototype.pos=function(){return this.position},e.prototype.goBackTo=function(e){this.position=e},e.prototype.goBack=function(e){this.position-=e},e.prototype.advance=function(e){this.position+=e},e.prototype.goToEnd=function(){this.position=this.source.length},e.prototype.nextChar=function(){return this.source.charCodeAt(this.position++)||0},e.prototype.peekChar=function(e){return void 0===e&&(e=0),this.source.charCodeAt(this.position+e)||0},e.prototype.advanceIfChar=function(e){return e===this.source.charCodeAt(this.position)&&(this.position++,!0)},e.prototype.advanceIfChars=function(e){var t;if(this.position+e.length>this.source.length)return!1;for(t=0;t<e.length;t++)if(this.source.charCodeAt(this.position+t)!==e[t])return!1;return this.advance(t),!0},e.prototype.advanceIfRegExp=function(e){var t=this.source.substr(this.position).match(e);return t?(this.position=this.position+t.index+t[0].length,t[0]):""},e.prototype.advanceUntilRegExp=function(e){var t=this.source.substr(this.position).match(e);return t?(this.position=this.position+t.index,t[0]):(this.goToEnd(),"")},e.prototype.advanceUntilChar=function(e){for(;this.position<this.source.length;){if(this.source.charCodeAt(this.position)===e)return!0;this.advance(1)}return!1},e.prototype.advanceUntilChars=function(e){for(;this.position+e.length<=this.source.length;){for(var t=0;t<e.length&&this.source.charCodeAt(this.position+t)===e[t];t++);if(t===e.length)return!0;this.advance(1)}return this.goToEnd(),!1},e.prototype.skipWhitespace=function(){return this.advanceWhileChar((function(e){return e===y||e===C||e===f||e===g||e===S}))>0},e.prototype.advanceWhileChar=function(e){for(var t=this.position;this.position<this.len&&e(this.source.charCodeAt(this.position));)this.position++;return this.position-t},e}(),i="!".charCodeAt(0),c="-".charCodeAt(0),s="<".charCodeAt(0),p=">".charCodeAt(0),h="/".charCodeAt(0),u="=".charCodeAt(0),T='"'.charCodeAt(0),d="'".charCodeAt(0),f="\n".charCodeAt(0),S="\r".charCodeAt(0),g="\f".charCodeAt(0),y=" ".charCodeAt(0),C="\t".charCodeAt(0),l={"text/x-handlebars-template":!0};t.createScanner=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=a.ScannerState.WithinContent);var f,S,g,y,C,k=new o(e,t),v=n,W=0,x=a.TokenType.Unknown;function A(){return k.advanceIfRegExp(/^[_:\w][_:\w-.\d]*/).toLowerCase()}function m(e,t,n){return x=t,W=e,f=n,t}function E(){var e,t=k.pos();if(k.eos())return m(t,a.TokenType.EOS);switch(v){case a.ScannerState.WithinComment:return k.advanceIfChars([c,c,p])?(v=a.ScannerState.WithinContent,m(t,a.TokenType.EndCommentTag)):(k.advanceUntilChars([c,c,p]),m(t,a.TokenType.Comment));case a.ScannerState.WithinDoctype:return k.advanceIfChar(p)?(v=a.ScannerState.WithinContent,m(t,a.TokenType.EndDoctypeTag)):(k.advanceUntilChar(p),m(t,a.TokenType.Doctype));case a.ScannerState.WithinContent:if(k.advanceIfChar(s)){if(!k.eos()&&k.peekChar()===i){if(k.advanceIfChars([i,c,c]))return v=a.ScannerState.WithinComment,m(t,a.TokenType.StartCommentTag);if(k.advanceIfRegExp(/^!doctype/i))return v=a.ScannerState.WithinDoctype,m(t,a.TokenType.StartDoctypeTag)}return k.advanceIfChar(h)?(v=a.ScannerState.AfterOpeningEndTag,m(t,a.TokenType.EndTagOpen)):(v=a.ScannerState.AfterOpeningStartTag,m(t,a.TokenType.StartTagOpen))}return k.advanceUntilChar(s),m(t,a.TokenType.Content);case a.ScannerState.AfterOpeningEndTag:return A().length>0?(v=a.ScannerState.WithinEndTag,m(t,a.TokenType.EndTag)):k.skipWhitespace()?m(t,a.TokenType.Whitespace,r("error.unexpectedWhitespace","Tag name must directly follow the open bracket.")):(v=a.ScannerState.WithinEndTag,k.advanceUntilChar(p),t<k.pos()?m(t,a.TokenType.Unknown,r("error.endTagNameExpected","End tag name expected.")):E());case a.ScannerState.WithinEndTag:if(k.skipWhitespace())return m(t,a.TokenType.Whitespace);if(k.advanceIfChar(p))return v=a.ScannerState.WithinContent,m(t,a.TokenType.EndTagClose);e=r("error.tagNameExpected","Closing bracket expected.");break;case a.ScannerState.AfterOpeningStartTag:return g=A(),C=void 0,y=void 0,g.length>0?(S=!1,v=a.ScannerState.WithinTag,m(t,a.TokenType.StartTag)):k.skipWhitespace()?m(t,a.TokenType.Whitespace,r("error.unexpectedWhitespace","Tag name must directly follow the open bracket.")):(v=a.ScannerState.WithinTag,k.advanceUntilChar(p),t<k.pos()?m(t,a.TokenType.Unknown,r("error.startTagNameExpected","Start tag name expected.")):E());case a.ScannerState.WithinTag:return k.skipWhitespace()?(S=!0,m(t,a.TokenType.Whitespace)):S&&(y=k.advanceIfRegExp(/^[^\s"'>/=\x00-\x0F\x7F\x80-\x9F]*/).toLowerCase()).length>0?(v=a.ScannerState.AfterAttributeName,S=!1,m(t,a.TokenType.AttributeName)):k.advanceIfChars([h,p])?(v=a.ScannerState.WithinContent,m(t,a.TokenType.StartTagSelfClose)):k.advanceIfChar(p)?(v="script"===g?C&&l[C]?a.ScannerState.WithinContent:a.ScannerState.WithinScriptContent:"style"===g?a.ScannerState.WithinStyleContent:a.ScannerState.WithinContent,m(t,a.TokenType.StartTagClose)):(k.advance(1),m(t,a.TokenType.Unknown,r("error.unexpectedCharacterInTag","Unexpected character in tag.")));case a.ScannerState.AfterAttributeName:return k.skipWhitespace()?(S=!0,m(t,a.TokenType.Whitespace)):k.advanceIfChar(u)?(v=a.ScannerState.BeforeAttributeValue,m(t,a.TokenType.DelimiterAssign)):(v=a.ScannerState.WithinTag,E());case a.ScannerState.BeforeAttributeValue:if(k.skipWhitespace())return m(t,a.TokenType.Whitespace);var n=k.advanceIfRegExp(/^[^\s"'`=<>\/]+/);if(n.length>0)return"type"===y&&(C=n),v=a.ScannerState.WithinTag,S=!1,m(t,a.TokenType.AttributeValue);var o=k.peekChar();return o===d||o===T?(k.advance(1),k.advanceUntilChar(o)&&k.advance(1),"type"===y&&(C=k.getSource().substring(t+1,k.pos()-1)),v=a.ScannerState.WithinTag,S=!1,m(t,a.TokenType.AttributeValue)):(v=a.ScannerState.WithinTag,S=!1,E());case a.ScannerState.WithinScriptContent:for(var f=1;!k.eos();){var W=k.advanceIfRegExp(/<!--|-->|<\/?script\s*\/?>?/i);if(0===W.length)return k.goToEnd(),m(t,a.TokenType.Script);if("\x3c!--"===W)1===f&&(f=2);else if("--\x3e"===W)f=1;else if("/"!==W[1])2===f&&(f=3);else{if(3!==f){k.goBack(W.length);break}f=2}}return v=a.ScannerState.WithinContent,t<k.pos()?m(t,a.TokenType.Script):E();case a.ScannerState.WithinStyleContent:return k.advanceUntilRegExp(/<\/style/i),v=a.ScannerState.WithinContent,t<k.pos()?m(t,a.TokenType.Styles):E()}return k.advance(1),v=a.ScannerState.WithinContent,m(t,a.TokenType.Unknown,e)}return{scan:function(){var e=k.pos(),t=v,n=E();return n!==a.TokenType.EOS&&e===k.pos()?(console.log("Scanner.scan has not advanced at offset "+e+", state before: "+t+" after: "+v),k.advance(1),m(e,a.TokenType.Unknown)):n},getTokenType:function(){return x},getTokenOffset:function(){return W},getTokenLength:function(){return k.pos()-W},getTokenEnd:function(){return k.pos()},getTokenText:function(){return k.getSource().substring(W,k.pos())},getScannerState:function(){return v},getTokenError:function(){return f}}}}));